heaviside <- function(x) c(0L, NA_integer_, 1L)[2 + sign(x)]
